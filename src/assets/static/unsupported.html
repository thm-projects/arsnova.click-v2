<!doctype html>
<html>
<head>
  <title>arsnova.click</title>
</head>
<body style="font-size:18px;font-size: 1.2rem;">
<p lang="en"
   style="font-size:22px;font-size: 1.4rem;display: none;">Your browser is unsupported!<br/>Please check which browser supports the required features (click on Details of every item) to use arsnova.click</p>
<p lang="de"
   style="font-size:22px;font-size: 1.4rem;display: none;">Dein Browser wird nicht unterst&uuml;tzt!<br/>Bitte pr&uuml;fe, welcher Browser die erforderlichen Features unterst&uuml;tzt (klicke auf Details in jedem Element der Liste) um arsnova.click nutzen zu k&ouml;nnen</p>
<p lang="en"
   style="display: none;">Your browser is missing the following mandatory features&colon;</p>
<p lang="de"
   style="display: none;">Dein Browser unterst&uuml;tzt nicht die folgenden erforderlichen Features&colon;</p>
<ul id="list-required"></ul>

<p lang="en"
   style="display: none;">Additional it is missing the following optional features&colon;</p>
<p lang="de"
   style="display: none;">Zus&auml;tzlich unterst&uuml;tzt er nicht die folgenden optionalen Features&colon;</p>
<ul id="list-optional"></ul>

<script>
  var lang = navigator.language.split('-')[0];
  var textNodes = document.getElementsByTagName('p');
  for (var i = 0; i < textNodes.length; i++) {
    if (textNodes.item(i).getAttribute('lang') === lang) {
      textNodes.item(i).setAttribute('style', '');
    }
  }

  var fn = function () {
    var requiredListNode = document.getElementById('list-required');
    while (requiredListNode.firstChild) {
      requiredListNode.removeChild(requiredListNode.firstChild);
    }
    var optionalListNode = document.getElementById('list-optional');
    while (optionalListNode.firstChild) {
      optionalListNode.removeChild(optionalListNode.firstChild);
    }
    var list = [{label: 'Audio', value: Modernizr.audio, required: false, linkRef: '#feat=audio'},
        {label: 'BlobConstructor', value: Modernizr.blobconstructor, required: false, linkRef: '#feat=blobbuilder'},
        {label: 'IndexedDB', value: 'indexedDB' in window, required: true, linkRef: '#feat=indexeddb'}, // TODO: Value resolves to a promise
        {label: 'ClassList', value: Modernizr.classlist, required: true, linkRef: '#feat=classlist'},
        {label: 'CORS', value: Modernizr.cors, required: true, linkRef: '#feat=cors'},
        {label: 'CSS-Calc', value: Modernizr.csscalc, required: true, linkRef: '#feat=calc'},
        {label: 'es5', value: Modernizr.es5, required: true, linkRef: '#feat=es5'},
        {label: 'FileInput', value: Modernizr.fileinput, required: false, linkRef: '#search=File%20Input'},
        {label: 'Flexbox', value: Modernizr.flexbox, required: true, linkRef: '#feat=flexbox'},
        {label: 'Flex-wrap', value: Modernizr.flexwrap, required: true, linkRef: '#feat=flexbox'},
        {label: 'Fullscreen', value: Modernizr.fullscreen, required: false, linkRef: '#feat=fullscreen'},
        {label: 'JSON', value: Modernizr.json, required: true, linkRef: '#feat=json'},
        {label: 'LocalStorage', value: Modernizr.localstorage, required: true, linkRef: '#feat=namevalue-storage'},
        {label: 'Promises', value: Modernizr.promises, required: true, linkRef: '#feat=promises'},
        {label: 'ServiceWorker', value: Modernizr.serviceworker, required: false, linkRef: '#feat=serviceworkers'},
        {label: 'SessionStorage', value: Modernizr.sessionstorage, required: true, linkRef: '#feat=namevalue-storage'},
        {label: 'SVG', value: Modernizr.svg, required: true, linkRef: '#feat=svg'},
        {label: 'Video', value: Modernizr.video, required: false, linkRef: '#feat=video'},
        {label: 'WebSockets', value: Modernizr.websockets, required: true, linkRef: '#feat=websockets'},
        {label: 'XHR-Response', value: Modernizr.xhrresponsetype, required: true, linkRef: '#feat=xhr2'},
        {label: 'Uint8Array', value: 'Uint8Array' in window, required: true, linkRef: '#feat=mdn-javascript_builtins_uint8array'},
        {label: 'TextEncoder', value: 'TextEncoder' in window, required: true, linkRef: '#feat=textencoder'},
        {label: 'TextDecoder', value: 'TextDecoder' in window, required: true, linkRef: '#feat=mdn-api_textdecoder'},
        {label: 'Object.assign', value: 'assign' in Object, required: false, linkRef: '#feat=es6'},
      ]
    ;

    list.forEach(function (elem) {
      if (elem.value) {
        return;
      }

      console.log(elem);

      var node = document.createElement('li');
      node.innerHTML = elem.label + ' (<a target="_blank" href="https://caniuse.com/' + elem.linkRef + '">Details</a>)';
      node.className = 'failed';
      document.getElementById('list-' + (elem.required ? 'required' : 'optional')).appendChild(node);
    });
  };

  document.addEventListener('DOMContentLoaded', fn, false);
  window.addEventListener('load', fn, false);
  if ('attachEvent' in document) {
    document.attachEvent("onreadystatechange", fn);
  }
  if ('attachEvent' in window) {
    window.attachEvent("onload", fn);
  }
</script>

<script crossorigin="anonymous"
        src="/assets/js/modernizr/modernizr-custom.js"></script>

</body>
</html>
